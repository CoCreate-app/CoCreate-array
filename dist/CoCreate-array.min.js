!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.array=t():(e.CoCreate=e.CoCreate||{},e.CoCreate.array=t())}(this,function(){return a={},o.m=r=[function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t,r){"use strict";r.r(t);var a=r(0),u=r.n(a);function o(){CoCreate.socket.listen("connect",function(e,t){console.log("socket connected"),t==CoCreate.socket.getGlobalScope()&&l()}),CoCreate.socket.listen("createDocument",function(e){d(e)}),CoCreate.socket.listen("readDocument",function(e){m(e)}),CoCreate.socket.listen("updateDocument",function(e){m(e)})}function n(){for(var e=document.querySelectorAll("form"),t=0;t<e.length;t++)c(e[t])}function c(e){for(var t=e.querySelectorAll("[data-array_name]"),r=0;r<t.length;r++)i(e,t[r])}function i(e,a){var t=e.getAttribute("data-realtime"),o=e.getAttribute("data-collection")?e.getAttribute("data-collection"):"module_activity";if("false"!=t&&(a.addEventListener("change",function(e){e.preventDefault();var t=this.getAttribute("data-array_name"),r=f(0,a),e=o==this.getAttribute("data-document_id");e&&CoCreate.crud.updateDocument({collection:o,document_id:e,data:u()({},t,r),metadata:""})}),"SELECT"!=a.tagName))for(var r=a.querySelectorAll('input[type="checkbox"]'),n=0;n<r.length;n++)r[n].addEventListener("change",function(e){e.preventDefault()})}function l(){s()}function d(e){var t=e.element,t=document.querySelector("form[data-form_id='"+t+"']");if(t)for(var r=t.getElementsByClassName("arrayField"),a=(t.getAttribute("data-collection"),0);a<r.length;a++){var o=r[a];o.getAttribute("data-document_id")||o.setAttribute("data-document_id",e.document_id)}}function f(e,t){var r=[];if("SELECT"==t.tagName){var a=t.value;r.push(a)}else for(var o=t.querySelectorAll('input[type="checkbox"]'),n=0;n<o.length;n++){var c=o[n];c.checked&&(a=c.value,r.push(a))}return console.log(r),r}function m(e){for(var t=e.collection,r=document.querySelectorAll("form"),a=0;a<r.length;a++){var o=r[a];if((o.getAttribute("data-collection")?o.getAttribute("data-collection"):"module_activity")==t)for(var n=o.querySelectorAll("[data-array_name]"),c=0;c<n.length;c++){var u=n[c];u.getAttribute("data-document_id")===e.document_id&&y(u,e.data)}}}function y(e,t){var r=e.getAttribute("data-array_name");if(r in t){var a=t[r];if("SELECT"==e.tagName)0<a.length?e.value=a[0]:e.value=null;else for(var o=e.querySelectorAll('input[type="checkbox"]'),n=0;n<o.length;n++){var c=o[n];-1<a.indexOf(c.value)?c.checked=!0:c.checked=!1}}}function s(){for(var e=[],t=document.querySelectorAll("form"),r=0;r<t.length;r++)for(var a=t[r],o=a.getAttribute("data-collection")?a.getAttribute("data-collection"):"module_activity",n=a.querySelectorAll("[data-array_name]"),c=0;c<n.length;c++){var u=n[c].getAttribute("data-document_id");if(u){for(var i=!1,l=0;l<e.length;l++)o!=e[l]["data-collection"]||u!=e[l].id||(i=!0);i||e.push({"data-collection":o,id:u})}}e.forEach(function(e){CoCreate.crud.readDocument({collection:e["data-collection"],document_id:e.id,metadata:""})})}o(),n();a={fetchArrays:s,updateArrayData:y,fetchedDataForArray:m,updateArray:function(e){for(var t=e.getAttribute("data-collection")||"module_activity",r=e.querySelectorAll("[data-array_name]"),a=0;a<r.length;a++){var o=r[a],n=o.getAttribute("data-array_name"),c=f(0,o),o=o.getAttribute("data-document_id");o&&CoCreate.crud.updateDocument({collection:t,document_id:o,data:u()({},n,c),metadata:""})}},getArrayValue:f,insertCreatedIdToArray:d,socketConnectedForArray:l,initArrayTag:i,initArrayTags:c,initArrayForms:n,initSocketsForArray:o};t.default=a}],o.c=a,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(r,a,function(e){return t[e]}.bind(null,a));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=1).default;function o(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}var r,a});